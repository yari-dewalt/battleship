(()=>{"use strict";class e{constructor(){this.board=Array.from({length:10},(()=>Array(10).fill(""))),this.ships=[],this.missedAttacks=[]}placeShip(e,t,a,s){if(this.isValidPlacement(e,t,a,s)){for(let i=0;i<e.length;i++)"horizontal"===s?this.board[t][a+i]=e:this.board[t+i][a]=e;return this.ships.push({ship:e,row:t,col:a,orientation:s}),!0}return!1}isValidPlacement(e,t,a,s){if("horizontal"===s&&a+e.length>10||"vertical"===s&&t+e.length>10)return!1;for(let i=0;i<e.length;i++){if("horizontal"===s&&""!=this.board[t][a+i])return!1;if("vertical"===s&&""!=this.board[t+i][a])return!1}return!0}receiveAttack(e,t){for(const a of this.ships){const{ship:s,row:i,col:r,orientation:o}=a;if("horizontal"===o&&e===i&&t>=r&&t<r+s.length||"vertical"===o&&t===r&&e>=i&&e<i+s.length)return s.hit(),this.board[e][t]="hit",!0}return this.missedAttacks.push({row:e,col:t}),this.board[e][t]="miss",!1}allShipsSunk(){return this.ships.every((e=>e.ship.isSunk()))}}class t{constructor(e){this.length=e,this.num_hits=0,this.is_sunk=!1}hit(){return this.num_hits++,this.num_hits}isSunk(){return this.num_hits===this.length&&(this.is_sunk=!0),this.is_sunk}}const a=document.getElementsByClassName("gameboard"),s=a[0],i=a[1],r=document.getElementsByClassName("ship-info");let o,n,l="horizontal";const h=new class{constructor(){this.gameboard=new e,this.isTurn=!0}createShip(e){let a=new t(e);return this.gameboard.ships.push(a),a}makeMove(e,t,a){e.receiveAttack(t,a)}},d=new class{constructor(){this.gameboard=new e,this.previousAttacks=[],this.isTurn=!1}makeMove(e){let t=Math.floor(10*Math.random()),a=Math.floor(10*Math.random());for(;this.hasAttackedBefore(t,a);)t=Math.floor(10*Math.random()),a=Math.floor(10*Math.random());e.receiveAttack(t,a),this.previousAttacks.push({randomRow:t,randomCol:a})}hasAttackedBefore(e,t){return this.previousAttacks.some((a=>a.row===e&&a.col===t))}};function c(e,t){for(;s.lastChild;)s.removeChild(s.lastChild);for(;i.lastChild;)i.removeChild(i.lastChild);for(let t=0;t<e.board.length;t++){let a=document.createElement("div");a.className="grid-row";for(let s=0;s<e.board[t].length;s++){let i=document.createElement("div");i.className="grid-square";let r=document.createElement("div");""==e.board[t][s]?r.className="square-identity water":"miss"===e.board[t][s]?r.className="square-identity miss":"hit"===e.board[t][s]?r.className="square-identity hit":r.className="square-identity ship",i.appendChild(r),i.addEventListener("click",(()=>{h.gameboard.placeShip(o,t,s,l)&&(n.className="ship-info placed",o=null),c(h.gameboard,d.gameboard)})),a.appendChild(i)}s.appendChild(a)}for(let e=0;e<t.board.length;e++){let a=document.createElement("div");a.className="grid-row";for(let s=0;s<t.board[e].length;s++){let i=document.createElement("div");i.className="grid-square";let r=document.createElement("div");""==t.board[e][s]?r.className="square-identity water":"miss"===t.board[e][s]?r.className="square-identity miss":"hit"===t.board[e][s]?r.className="square-identity hit":r.className="square-identity ship",i.appendChild(r),i.addEventListener("click",(()=>{h.makeMove(d.gameboard,e,s),c(h.gameboard,d.gameboard)})),a.appendChild(i)}i.appendChild(a)}}Array.from(r).forEach(((e,t)=>{e.addEventListener("click",(()=>{"ship-info placed"!==e.className&&(Array.from(r).forEach((e=>{"ship-info placed"!==e.className&&(e.className="ship-info")})),e.className="ship-info selected",o=h.createShip(r[t].lastElementChild.childElementCount),n=e)}))})),document.addEventListener("keydown",(e=>{if("f"===e.key||"F"===e.key){if("horizontal"===l)return l="vertical",void console.log(l);if("vertical"===l)return l="horizontal",void console.log(l)}})),c(h.gameboard,d.gameboard),d.makeMove(h.gameboard),c(h.gameboard,d.gameboard),h.makeMove(d.gameboard,1,2),c(h.gameboard,d.gameboard)})();