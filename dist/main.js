(()=>{"use strict";class e{constructor(){this.board=Array.from({length:10},(()=>Array(10).fill(""))),this.ships=[],this.missedAttacks=[]}placeShip(e,t,a,s){if(this.isValidPlacement(e,t,a,s)){for(let r=0;r<e.length;r++)"horizontal"===s?this.board[t][a+r]=e:this.board[t+r][a]=e;return this.ships.push({ship:e,row:t,col:a,orientation:s}),!0}return!1}isValidPlacement(e,t,a,s){if("horizontal"===s&&a+e.length>10||"vertical"===s&&t+e.length>10)return!1;for(let r=0;r<e.length;r++){if("horizontal"===s&&""!=this.board[t][a+r])return!1;if("vertical"===s&&""!=this.board[t+r][a])return!1}return!0}receiveAttack(e,t){for(const a of this.ships){const{ship:s,row:r,col:i,orientation:o}=a;if("horizontal"===o&&e===r&&t>=i&&t<i+s.length||"vertical"===o&&t===i&&e>=r&&e<r+s.length)return s.hit(),this.board[e][t]="hit",!0}return this.missedAttacks.push({row:e,col:t}),this.board[e][t]="miss",!1}allShipsSunk(){return this.ships.every((e=>e.ship.isSunk()))}}class t{constructor(e){this.length=e,this.num_hits=0,this.is_sunk=!1}hit(){return this.num_hits++,this.num_hits}isSunk(){return this.num_hits===this.length&&(this.is_sunk=!0),this.is_sunk}}const a=document.getElementsByClassName("gameboard"),s=a[0],r=a[1],i=document.getElementsByClassName("ship-info");let o;Array.from(i).forEach(((e,t)=>{e.addEventListener("click",(()=>{o=n.createShip(i[t].lastElementChild.childElementCount),console.log(o)}))}));const n=new class{constructor(){this.gameboard=new e,this.isTurn=!0}createShip(e){let a=new t(e);return this.gameboard.ships.push(a),a}makeMove(e,t,a){e.receiveAttack(t,a)}},h=new class{constructor(){this.gameboard=new e,this.previousAttacks=[],this.isTurn=!1}makeMove(e){let t=Math.floor(10*Math.random()),a=Math.floor(10*Math.random());for(;this.hasAttackedBefore(t,a);)t=Math.floor(10*Math.random()),a=Math.floor(10*Math.random());e.receiveAttack(t,a),this.previousAttacks.push({randomRow:t,randomCol:a})}hasAttackedBefore(e,t){return this.previousAttacks.some((a=>a.row===e&&a.col===t))}};function l(e,t){for(;s.lastChild;)s.removeChild(s.lastChild);for(;r.lastChild;)r.removeChild(r.lastChild);for(let t=0;t<e.board.length;t++){let a=document.createElement("div");a.className="grid-row";for(let s=0;s<e.board[t].length;s++){let r=document.createElement("div");r.className="grid-square";let i=document.createElement("div");""==e.board[t][s]?i.className="square-identity water":"miss"===e.board[t][s]?i.className="square-identity miss":"hit"===e.board[t][s]?i.className="square-identity hit":i.className="square-identity ship",r.appendChild(i),r.addEventListener("click",(()=>{n.gameboard.placeShip(o,t,s,"horizontal"),l(n.gameboard,h.gameboard)})),a.appendChild(r)}s.appendChild(a)}for(let e=0;e<t.board.length;e++){let a=document.createElement("div");a.className="grid-row";for(let s=0;s<t.board[e].length;s++){let r=document.createElement("div");r.className="grid-square";let i=document.createElement("div");""==t.board[e][s]?i.className="square-identity water":"miss"===t.board[e][s]?i.className="square-identity miss":"hit"===t.board[e][s]?i.className="square-identity hit":i.className="square-identity ship",r.appendChild(i),r.addEventListener("click",(()=>{n.makeMove(h.gameboard,e,s),l(n.gameboard,h.gameboard)})),a.appendChild(r)}r.appendChild(a)}}n.createShip(2),n.createShip(4),l(n.gameboard,h.gameboard),h.makeMove(n.gameboard),l(n.gameboard,h.gameboard),n.makeMove(h.gameboard,1,2),l(n.gameboard,h.gameboard)})();